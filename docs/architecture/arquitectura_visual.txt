
╔════════════════════════════════════════════════════════════════════════════════════════╗
║           ARQUITECTURA DE DATOS - BARCELONA HOUSING DEMOGRAPHICS ANALYZER             ║
║                    Captura de 33 Variables de Precios de Vivienda                     ║
╚════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              CAPA DE FUENTES DE DATOS (16+)                            │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                         │
│  DEMOGRÁFICAS        │ ECONÓMICAS         │ OFERTA/DEMANDA    │ UBICACIÓN             │
│  ─────────────────   │ ──────────────────  │ ──────────────── │ ────────────────────  │
│  • INE Padrón        │ • SEPE Desempleo   │ • Colegio        │ • CartoBCN           │
│  • Open Data BCN     │ • INE EPA          │   Arquitectos    │ • TMB GTFS           │
│  • Portal Dades      │ • IDESCAT          │ • Catastro       │ • OpenStreetMap      │
│  • Catastro          │ • Portal Dades     │ • Portal Dades   │ • Cálculo geométrico │
│                      │                    │                  │                      │
│  TURISMO            │ REGULACIÓN        │ EFICIENCIA       │ FINANCIERA            │
│  ─────────────────  │ ──────────────────  │ ────────────────│ ──────────────────    │
│  • Ajuntament BCN   │ • Generalitat      │ • Portal Dades  │ • BCE                │
│  • Inside Airbnb    │ • BOE              │ • Certificados  │ • Banco España       │
│  • Oficina Turisme  │ • INCASL           │   EPC           │ • Hipotecarios       │
│                      │ • Planejament Urbà │                 │                       │
│                                                                                         │
│  AMBIENTE                                                                              │
│  ──────────────────────────────────                                                   │
│  • Ajuntament (Qualitat aire, Ruido)                                                  │
│  • Agencia Salud Pública Barcelona                                                    │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                         ↓
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                         CAPA DE EXTRACCIÓN (18 EXTRACTORES)                            │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                         │
│  FASE 2 (Semana 3-6): CRÍTICOS              FASE 3 (Semana 7-10): COMPLEMENTARIOS      │
│  ──────────────────────────────────────────  ─────────────────────────────────────────  │
│  ✅ DesempleoExtractor (SEPE)               ✅ VisadosExtractor (Colegio Arq)         │
│  ✅ EducacionExtractor (Portal Dades)       ✅ ControlAlquilerExtractor (Generalitat) │
│  ✅ HUTExtractor (Ajuntament)                ✅ CentralidadExtractor (Cálculo)         │
│  ✅ AirbnbExtractor (Inside Airbnb)         ✅ AccesibilidadExtractor (TMB/GTFS)      │
│                                              ✅ EficienciaEnergeticaExtractor (EPC)   │
│  Impacto: 4 vars × ~400k registros          ✅ AmbienteExtractor (Ajuntament)        │
│                                                                                         │
│                                              Impacto: 6 vars × ~300k registros        │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                         ↓
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                   CAPA DE PROCESAMIENTO (DATA PROCESSING + NORMALIZATION)              │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                         │
│  • Normalización de territorios (barrioid mapping)                                     │
│  • Validación de tipos de datos y rangos                                              │
│  • Deduplicación inteligente (preservar múltiples datasets)                           │
│  • Agregación temporal (mensual → anual si es necesario)                              │
│  • Distribución ponderada (datos distrito → barrios)                                  │
│  • Detección de outliers y tratamiento de nulos                                       │
│  • Cálculo de métricas derivadas (densidad, ratios, índices)                          │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                         ↓
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                        CAPA DE BASE DE DATOS (STAR SCHEMA)                            │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│  DIMENSIONES (3):                         HECHOS (13):                                  │
│  ─────────────                            ──────────────                               │
│  • dim_barrios                            • fact_demografia                            │
│    (73 barrios + geometría GeoJSON)       • fact_demografia_ampliada                   │
│                                           • fact_precios ⭐ CORE                        │
│  • dim_barrios_metricas ⭐ NUEVA         • fact_renta ⭐ CORE                          │
│    (centralidad, accesibilidad,          • fact_oferta_idealista                       │
│     equipamientos, densidad)             ├─ fact_hogares ⭐ NUEVA                      │
│                                           ├─ fact_socioeconomic ⭐ NUEVA               │
│  • dim_barrios_ambiente ⭐ NUEVA         ├─ fact_construccion ⭐ NUEVA                 │
│    (aire, ruido, zonas verdes)           ├─ fact_movilidad ⭐ NUEVA                    │
│                                           ├─ fact_turismo ⭐ NUEVA                      │
│  Registros: 73 cada uno (estático)       ├─ fact_regulacion ⭐ NUEVA                   │
│                                           ├─ fact_eficiencia ⭐ NUEVA                   │
│                                           └─ fact_financiera ⭐ NUEVA                   │
│                                                                                          │
│  Total BD: ~30,000 registros | 2010-2025 | 45+ variables | 73 barrios                 │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
                                         ↓
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                              CAPA DE ANÁLISIS & BI                                      │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│  ✨ ANÁLISIS HABILITADOS:                                                               │
│                                                                                          │
│  1️⃣  MODELOS MULTIVARIABLES                 6️⃣  ANÁLISIS DE GENTRIFICACIÓN             │
│      └─ Elasticidad precio-demanda           └─ Población + Renta + Turismo + Mejoras  │
│      └─ Impacto variables sobre precios      └─ Identificar barrios vulnerables        │
│                                                                                          │
│  2️⃣  ANÁLISIS REGULATORIO                    7️⃣  VALORACIÓN DE AMENIDADES              │
│      └─ Efecto control alquileres            └─ Impacto eficiencia energética         │
│      └─ Suelo protegido vs precios           └─ Proximidad servicios vs precio        │
│                                                                                          │
│  3️⃣  IMPACTO TURÍSTICO                       8️⃣  PROYECCIONES DE PRECIOS              │
│      └─ HUTs/Airbnb vs oferta residencial    └─ Modelos predictivos (15+ variables)  │
│      └─ Displacement poblacional              └─ Escenarios de política pública       │
│                                                                                          │
│  4️⃣  SEGMENTACIÓN TERRITORIAL                9️⃣  ANÁLISIS DE ASEQUIBILIDAD             │
│      └─ Clústers demográfico-económicos      └─ Ratio precio/renta histórico          │
│      └─ Patrones espaciales (autocorr.)      └─ Identificar zonas de exclusión        │
│                                                                                          │
│  5️⃣  MOVILIDAD POBLACIONAL                   🔟 COMPARACIÓN TEMPORAL                   │
│      └─ Flujos inter-barrios                  └─ Tendencias 2010-2025 (15 años)       │
│      └─ Atractivo relativo por barrio        └─ Breakpoints y cambios estructurales   │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘


╔════════════════════════════════════════════════════════════════════════════════════════╗
║                          CRONOGRAMA DE IMPLEMENTACIÓN                                 ║
╠════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                        ║
║  FASE 1: INFRAESTRUCTURA (Semana 1-2)     FASE 3: COMPLEMENTARIOS (Semana 7-10)      ║
║  ├─ Crear 8 tablas fact (8h)              ├─ VisadosExtractor (50h)                  ║
║  ├─ Crear 2 tablas dimension (6h)         ├─ CentralidadExtractor (40h)              ║
║  ├─ Índices + constraints (4h)            ├─ EficienciaExtractor (50h)               ║
║  └─ Schema.sql + migrations (4h)          ├─ AmbienteExtractor (Incl.)               ║
║                                            └─ Tests integración (30h)                 ║
║  TOTAL: 22h                                                                           ║
║                                            TOTAL: 170h                                ║
║                                                                                        ║
║  FASE 2: CRÍTICOS (Semana 3-6)            FASE 4: INTEGRACIÓN (Semana 11-12)         ║
║  ├─ DesempleoExtractor (40h)              ├─ Pipeline ETL v3.0 (40h)                 ║
║  ├─ EducacionExtractor (40h)              ├─ Validación multivariante (24h)          ║
║  ├─ HUTExtractor (35h)                    └─ Documentación (20h)                      ║
║  ├─ AirbnbExtractor (35h)                                                             ║
║  └─ Tests integración (20h)               TOTAL: 84h                                  ║
║                                                                                        ║
║  TOTAL: 170h                              GRAN TOTAL: 446 horas | 12 semanas         ║
║                                                                                        ║
╚════════════════════════════════════════════════════════════════════════════════════════╝


╔════════════════════════════════════════════════════════════════════════════════════════╗
║                           IMPACTO CUANTIFICADO                                        ║
╠══════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                         ║
║  MÉTRICA                    │ ACTUAL      │ PROPUESTO  │ MEJORA   │ IMPACT             ║
║  ────────────────────────────┼─────────────┼────────────┼──────────┼────────────────────║
║  Variables analizables      │ 12          │ 45+        │ +375%    │ 🟢🟢🟢🟢🟢          ║
║  Registros en BD            │ 14,500      │ ~30,000    │ +207%    │ 🟢🟢🟢🟢            ║
║  Tablas fact                │ 5           │ 13         │ +160%    │ 🟢🟢🟢🟢            ║
║  Cobertura temporal (años)  │ 10 (15-25)  │ 15 (10-25) │ +50%     │ 🟢🟢🟢              ║
║  Granularidad temporal      │ Anual       │ Anual+Mes  │ +Mensual │ 🟢🟢🟢              ║
║  Extractores operacionales  │ 6           │ 18         │ +200%    │ 🟢🟢🟢🟢            ║
║  Fuentes de datos           │ 8           │ 16+        │ +100%    │ 🟢🟢🟢              ║
║  Capacidad de análisis      │ Descriptiva │ Predictiva │ +Causa   │ 🟢🟢🟢🟢🟢          ║
║                                                                                         ║
╚════════════════════════════════════════════════════════════════════════════════════════╝

