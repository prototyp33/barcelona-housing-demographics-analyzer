# ==============================================================================
# Dependabot Configuration
# ==============================================================================
# Mantiene las dependencias actualizadas automáticamente.
# - Python: requirements.txt y requirements-dev.txt
# - GitHub Actions: workflows en .github/workflows/
# - Docker: Dockerfile y docker-compose.yml
#
# CONFIGURACIÓN:
# - Schedule: Lunes a las 09:00 (Europe/Madrid)
# - Auto-asignación: prototyp33 (tanto como assignee como reviewer)
# - Labels: Se añaden automáticamente según el ecosistema
# - Commit prefix: deps(python), deps(actions), deps(docker)
#
# INTEGRACIÓN CON WORKFLOWS:
# Los PRs creados por Dependabot con prefijo 'deps(...)' son detectados
# automáticamente por el workflow 'auto-label-pr.yml' que añade labels
# adicionales y asigna al owner.
#
# GRUPOS DE DEPENDENCIAS:
# - data-processing: pandas, numpy, geopandas (agrupadas para reducir PRs)
# - visualization: plotly, streamlit (agrupadas para reducir PRs)
# - testing: pytest, coverage (agrupadas para reducir PRs)
#
# IGNORES:
# - Major versions de pandas y streamlit (pueden romper compatibilidad)
# ==============================================================================

version: 2
updates:
  # Python dependencies
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Europe/Madrid"
    open-pull-requests-limit: 5
    commit-message:
      prefix: "deps(python)"
    labels:
      - "dependencies"
      - "python"
    assignees:
      - "prototyp33"
    reviewers:
      - "prototyp33"
    groups:
      # ========================================================================
      # AGRUPACIÓN DE DEPENDENCIAS
      # ========================================================================
      # Agrupa actualizaciones de dependencias relacionadas en un solo PR
      # para reducir el ruido y facilitar la revisión.
      # ========================================================================
      data-processing:
        # Librerías de procesamiento de datos (actualizaciones agrupadas)
        patterns:
          - "pandas*"
          - "numpy*"
          - "geopandas*"
      visualization:
        # Librerías de visualización (actualizaciones agrupadas)
        patterns:
          - "plotly*"
          - "streamlit*"
      testing:
        # Herramientas de testing (actualizaciones agrupadas)
        patterns:
          - "pytest*"
          - "coverage*"
    ignore:
      # ========================================================================
      # DEPENDENCIAS IGNORADAS
      # ========================================================================
      # Ignora actualizaciones major que podrían romper compatibilidad.
      # Estas actualizaciones requieren revisión manual y testing exhaustivo.
      # ========================================================================
      - dependency-name: "pandas"
        update-types: ["version-update:semver-major"]
        # Razón: Cambios breaking en API pueden afectar transformaciones ETL
      - dependency-name: "streamlit"
        update-types: ["version-update:semver-major"]
        # Razón: Cambios breaking pueden afectar el dashboard futuro

  # GitHub Actions
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Europe/Madrid"
    open-pull-requests-limit: 3
    commit-message:
      prefix: "deps(actions)"
    labels:
      - "dependencies"
      - "github-actions"
    assignees:
      - "prototyp33"
    reviewers:
      - "prototyp33"

  # Docker (si usas contenedores)
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "09:00"
      timezone: "Europe/Madrid"
    open-pull-requests-limit: 2
    commit-message:
      prefix: "deps(docker)"
    labels:
      - "dependencies"
      - "docker"
    assignees:
      - "prototyp33"

